<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Test custom app</title>
  <!-- Stylesheets -->
  <link rel="stylesheet" type="text/css" href="https://matus12.github.io/customElements/css/kontent-ai-app-styles.css">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
  <script src="https://matus12.github.io/customElements/custom-app.min.js"></script>

</head>

<body>
  <div>
    <strong>Project id:</strong>
    <span id="projectId"></span>
  </div>
  <div>
    <strong>User id:</strong>
    <span id="userId"></span>
  </div>
  <div>
    <strong>User email:</strong>
    <span id="userEmail"></span>
  </div>
  <div>
    <strong>User role ids:</strong>
    <span id="userRoleIds"></span>
  </div>
  <div>
    <pre style="background-color:#eee">
      <code id="code">
      </code>
    </pre>
  </div>

  <script type="text/javascript">

    function updateSize() {
      // Updates the custom element height in the Kentico UI.
      const height = Math.ceil($('html').height());
      CustomElement.setHeight(height);
    }

    function updateDisabled(disabled) {
      isDisabled = disabled;
    }

    async function initCustomElement() {
      let projectId = '';
      try {
        CustomApp.init((config, context) => {
          console.log({config, context});
          document.getElementById("projectId").innerHTML = context.projectId;
          document.getElementById("userId").innerHTML = context.userId;
          document.getElementById("userEmail").innerHTML = context.userEmail;
          document.getElementById("userRoleIds").innerHTML = context.userRoleIds;
          projectId = context.projectId;
        });

        const response = await fetch(`https://deliver.kontent.ai/${projectId}/items`);
        const json = await response.json();
        document.getElementById("code").innerText = JSON.stringify(json, null, "\t");
      } catch (err) {
        console.error(err);
      }
    }

    initCustomElement();
  </script>
</body>
</html>
